(this.webpackJsonprice_explorer=this.webpackJsonprice_explorer||[]).push([[0],{322:function(e,t){},337:function(e,t,a){},341:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),s=a(25),r=a.n(s),o=a(18),i=a(368),l=a(358),d=a(376),j=a(359),u=a(373),b=a(360),p=a(8),h=a(61),m=a(4),O=a(100),f=a(353),x=a(26),g=a.n(x),y=a(14),v=a.n(y),N=a(16),S=a.n(N),_=a(23),C=a(350),A=a(351),k=a(375),w=(a(276),{upload:"Upload boundary file (shp)",MORANG:"MORANG",SUNSARI:"SUNSARI",JHAPA:"JHAPA",MAHOTTARI:"MAHOTTARI",PARSA:"PARSA",RAUTAHAT:"RAUTAHAT",SAPTARI:"SAPTARI",SARLAHI:"SARLAHI",SIRAHA:"SIRAHA",BARA:"BARA",DHANUSHA:"DHANUSHA",CHITAWAN:"CHITAWAN",NAWALPARASI_E:"NAWALPARASI_E",KAPILBASTU:"KAPILBASTU",NAWALPARASI_W:"NAWALPARASI_W",RUPANDEHI:"RUPANDEHI",BANKE:"BANKE",BARDIYA:"BARDIYA",DANG:"DANG",KAILALI:"KAILALI",KANCHANPUR:"KANCHANPUR"}),I={radar:{"COPERNICUS/S1_GRD":"Sentinel-1 SAR GRD: C-band Synthetic Aperture Radar Ground Range Detected, log scaling"},optical:{"LANDSAT/LT05/C01/T1_TOA":"USGS Landsat 5 TM Collection 1 Tier 1 TOA Reflectance","LANDSAT/LT05/C01/T1_SR":"USGS Landsat 5 Surface Reflectance Tier 1","LANDSAT/LC08/C01/T1_TOA":"USGS Landsat 8 Collection 1 Tier 1 TOA Reflectance","COPERNICUS/S2":"Sentinel-2 MSI: MultiSpectral Instrument, Level-1C","COPERNICUS/S2_SR":"Sentinel-2 MSI: MultiSpectral Instrument, Level-2A"}},T={VH:"VH band",VV:"VV band","VH/VV":"VH/VV (cross ratio)"},L={NDVI:"NDVI",EVI:"EVI",NDWI:"NDWI",MNDWI:"MNDWI"},D={"Google Maps":{url:"https://mt1.google.com/vt/lyrs=m&x={x}&y={y}&z={z}",attribution:"Google"},"Google Satellite":{url:"https://mt1.google.com/vt/lyrs=s&x={x}&y={y}&z={z}",attribution:"Google"},"Google Terrain":{url:"https://mt1.google.com/vt/lyrs=p&x={x}&y={y}&z={z}",attribution:"Google"},"ESRI World Imagery":{url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attribution:"Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community"}},R=a(21),P=Object(R.b)({name:"editing",initialState:!1,reducers:{toggle:function(e){return!e}}}),E=(P.actions.toggle,P.reducer),G=a(138),z=a(45),U=a.n(z),H=a(175),B=a(176),F=a.n(B),M=a(348),V=a(372),W=a(367),J=a(374),K=a(139),q=a.n(K),X=a(2),Y=Object(R.b)({name:"samples",initialState:{selected:null,geojson:{type:"FeatureCollection",features:[]},classProperty:{name:null,positiveValue:null},phenology:{start_date:"2019-01",end_date:"2019-12"}},reducers:{replace:function(e,t){return e.geojson=t.payload,e.selected=null,e},addFeatures:function(e,t){return e.geojson.features.push(t.payload),e},deleteFeature:function(e,t){var a=e.geojson.features.findIndex((function(e,a){return e.properties[oe]===t.payload}));e.geojson.features.splice(a,1)},selectFeature:function(e,t){e.selected=t.payload},setClassProperty:function(e,t){e.classProperty=Object(X.a)(Object(X.a)({},e.classProperty),t.payload)},changePhenologyDate:function(e,t){e.phenology=Object(X.a)(Object(X.a)({},e.phenology),t.payload)}}}),$=Y.actions,Q=$.replace,Z=($.addFeatures,$.deleteFeature),ee=$.selectFeature,te=$.setClassProperty,ae=$.changePhenologyDate,ne=Y.reducer,ce=a(349),se=a(52),re=a(1),oe="_$id",ie={radius:3,fillColor:"red",stroke:.2,color:"black",opacity:.5,fillOpacity:1},le={radius:3,fillColor:"blue",stroke:.2,color:"black",opacity:.5,fillOpacity:1},de=function(){var e=Object(p.c)((function(e){return e.samples})),t=Object(p.b)();Object(n.useEffect)((function(){null!==e.classProperty.name&&he.eachLayer((function(t){t.feature.properties[e.classProperty.name]===e.classProperty.positiveValue?t.setStyle(ie):t.setStyle(le)}))}),[e.classProperty]),Object(n.useEffect)((function(){if("number"===typeof e.selected){var t=e.geojson.features.filter((function(t){return t.properties[oe]==e.selected}))[0],a=Object(_.a)(t.geometry.coordinates).reverse();ge(a),he&&he.eachLayer((function(t){t.feature.properties[oe]===e.selected&&t.openPopup(a)}))}}),[e.selected,e.geojson]);var a=function(){var a=Object(H.a)(U.a.mark((function a(n){var c,s,r;return U.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!(n.target.files&&n.target.files.length>0)){a.next=16;break}return c=n.target.files[0],a.t0=q.a,a.next=5,c.arrayBuffer();case 5:return a.t1=a.sent,a.next=8,(0,a.t0)(a.t1);case 8:(s=a.sent).features.forEach((function(e,t){e.properties[oe]=t+1})),he&&ue.removeLayer(he),(r=S.a.geoJSON(s,{pointToLayer:function(t,a){return t.properties[e.classProperty.name]===e.classProperty.positiveValue?S.a.circleMarker(a,ie):S.a.circleMarker(a,le)},onEachFeature:function(e,t){t.bindPopup((function(e){return F.a.renderToString((t=e.feature.properties,Object(re.jsxs)(M.a,{striped:!0,bordered:!0,hover:!0,children:[Object(re.jsxs)("thead",{children:[Object(re.jsx)("th",{children:"key"}),Object(re.jsx)("th",{children:"value"})]}),Object(re.jsx)("tbody",{children:Object.entries(t).map((function(e){var t=Object(m.a)(e,2),a=t[0],n=t[1];return Object(re.jsxs)("tr",{children:[Object(re.jsx)("td",{children:a}),Object(re.jsx)("td",{children:JSON.stringify(n)})]},a)}))})]})));var t}),{maxHeight:"400",maxWidth:"400"})}})).addTo(ue),me(r),fe(),t(Q(s));case 16:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}();return Object(re.jsxs)(V.a,{className:"h-100 w-100 overflow-auto",children:[Object(re.jsx)(V.a.Header,{children:Object(re.jsxs)(u.a,{direction:"horizontal",gap:2,children:[Object(re.jsx)("div",{className:"me-auto",children:Object(re.jsxs)("h6",{className:"m-0 p-0",children:["Samples ","(count: ".concat(e.geojson.features.length,")")]})}),Object(re.jsxs)("div",{children:[Object(re.jsx)(O.a,{variant:"primary",size:"sm",className:"h-100 w-100",as:"label",htmlFor:"sample-uploa",children:"Upload"}),Object(re.jsx)("input",{type:"file",className:"d-none",id:"sample-uploa",onChange:a})]}),Object(re.jsx)("div",{children:Object(re.jsx)(O.a,{variant:"secondary",size:"sm",className:"h-100 w-100",onClick:function(t){console.log(e.geojson);var a=new Blob([JSON.stringify(e.geojson)],{type:"application/json"});Object(se.saveAs)(a,"samples.geojson")},children:"Download"})})]})}),Object(re.jsxs)(V.a.Body,{className:"p-2",children:[Object(re.jsx)("div",{className:"container card mb-2",children:Object(re.jsxs)("div",{className:"p-2",children:[Object(re.jsxs)("div",{className:"row align-items-center mb-2",children:[Object(re.jsx)("div",{className:"col-auto",children:"Class field:"}),Object(re.jsx)("div",{className:"col",children:Object(re.jsxs)(W.a.Select,{className:"w-100",value:e.classProperty.name||"",disabled:!e.geojson.features.length,onChange:function(e){return a=e.target.value,void t(te({name:a,positiveValue:null}));var a},children:[Object(re.jsx)("option",{}),0!==e.geojson.features.length&&Object.keys(e.geojson.features[0].properties).map((function(e){return Object(re.jsx)("option",{children:e},e)}))]})})]}),Object(re.jsxs)("div",{className:"row align-items-center",children:[Object(re.jsx)("div",{className:"col-auto",children:"Class value:"}),Object(re.jsx)("div",{className:"col",children:Object(re.jsxs)(W.a.Select,{value:e.classProperty.positiveValue||"",disabled:!e.classProperty.name,onChange:function(e){return a=e.target.value,void t(te({positiveValue:a}));var a},children:[Object(re.jsx)("option",{}),0!==e.geojson.features.length&&Object(_.a)(new Set(e.geojson.features.map((function(t){return t.properties[e.classProperty.name]})))).map((function(e){return Object(re.jsx)("option",{children:e},e)}))]})})]})]})}),Object(re.jsx)(J.a,{className:"sample-list",children:e.geojson&&e.geojson.features.map((function(e,t){return Object(re.jsx)(je,{feature:e,idx:t})}))})]})]})},je=function(e){var t=e.idx,a=e.feature,n=Object(p.c)((function(e){return e.samples})),c=Object(p.b)();return Object(re.jsx)(J.a.Item,{action:!0,className:"px-3 py-1",onClick:function(){return function(e){c(ee(e))}(a.properties[oe])},active:a.properties[oe]==n.selected,style:{backgroundColor:a.properties[n.classProperty.name]==n.classProperty.positiveValue?"lightgreen":null},children:Object(re.jsxs)("div",{className:"d-flex align-items-center flex-row justify-content-between",children:[Object(re.jsx)("div",{children:"".concat(a.properties[oe]," - ").concat(a.properties[n.classProperty.name])}),Object(re.jsx)("div",{children:Object(re.jsx)(O.a,{variant:"light",size:"sm",className:"h-100 w-100 px-0 bg-transparent",as:"label",onClick:function(e){return function(e,t){e.stopPropagation(),console.log(t),he.eachLayer((function(e){t===e.feature.properties[oe]&&he.removeLayer(e)})),c(Z(t)),c(ee(null))}(e,a.properties[oe])},children:Object(re.jsx)(ce.a,{})})})]})},t)};delete S.a.Icon.Default.prototype._getIconUrl,S.a.Icon.Default.mergeOptions({iconRetinaUrl:a(329).default,iconUrl:a(330).default,shadowUrl:a(331).default});var ue=null,be=null,pe=[],he=null,me=function(e){return he=e},Oe=function(e){ue&&be.current&&e.forEach((function(e){e.layer.addTo(ue),be.current.addOverlay(e.layer,e.name),pe.push(e.layer)}))},fe=function(){he&&ue&&be.current&&(he.addTo(ue),be.current.addOverlay(he,"samples"))},xe=function(e){pe.forEach((function(e){be.current.removeLayer(e),ue.removeLayer(e)}))},ge=function(e){var t=Object(m.a)(e,2),a=t[0],n=t[1];ue&&ue.panTo([a,n])};var ye=function(e){var t=Object(p.c)((function(e){return e.appName})),a=Object(n.useRef)(),c=Object(p.c)((function(e){return e.samples}));return Object(n.useEffect)((function(){be=a,setTimeout((function(){Oe(pe),fe()}),400)}),[]),Object(n.useEffect)((function(){if(c.selected){var e=c.geojson.features.filter((function(e){return e.properties[oe]===c.selected}))[0],t=Object(_.a)(e.geometry.coordinates).reverse();ge(t)}}),[c.selected]),Object(n.useEffect)((function(){ue&&ue.invalidateSize()}),[t]),Object(re.jsx)(C.a,{center:[28.5973518,83.54495724],zoom:8,id:"map",whenCreated:function(e){ue=e},children:Object(re.jsx)(A.a,{ref:a,children:Object.entries(D).map((function(e){var t=Object(m.a)(e,2),a=t[0],n=t[1];return Object(re.jsx)(A.a.BaseLayer,{name:a,checked:"Google Maps"===a,children:Object(re.jsx)(k.a,{url:n.url,attribution:n.attribution})},a)}))})})},ve=Object(R.b)({name:"appStatus",initialState:{status:"Ready",info:"Please run the app to show area of rice."},reducers:{setStatus:function(e,t){return e.status=t.payload,e},setInfo:function(e,t){return e.info=t.payload,e}}}),Ne=ve.actions,Se=(Ne.setStatus,Ne.setInfo,ve.reducer),_e=a(352),Ce=a(46),Ae=Object(R.b)({name:"log",initialState:"",reducers:{appendLog:function(e,t){var a=(new Date).toLocaleString();return e+="<p><b>[".concat(a,"]</b> ").concat(t.payload,"<br></p>")}}}),ke=Ae.actions.appendLog,we=Ae.reducer,Ie=function(e){var t=e.downloadUrl,a=Object(p.c)((function(e){return e.csrfToken})),n=Object(p.c)((function(e){return e.dataset})),c=Object(p.c)((function(e){return e.seasons})),s=Object(p.c)((function(e){return e.appName})),r=Object(p.c)((function(e){return e.classification})),o=Object(p.c)((function(e){return e.samples})),i=Object(p.b)();return Object(re.jsxs)(_e.a,{id:"export-dropdown",size:"sm",title:"Export",onSelect:function(e,l){return function(e){if("toJpeg"===e)""!==t&&Object(se.saveAs)(t,"result.jpg");else{var l=new FormData,d={};if("empirical"===s)d.op=c.op,d.seasons=c.seasons,d.dataset=v.a.cloneDeep(n),d.dataset.boundary_file&&(l.append("boundary_file",d.dataset.boundary_file),delete d.dataset.boundary_file),l.append("json",new Blob([JSON.stringify(d)],{type:"application/json"}));else if("classification"===s){d.dataset=v.a.cloneDeep(n),d.dataset.boundary_file&&(l.append("boundary_file",d.dataset.boundary_file),delete d.dataset.boundary_file),d.classification=v.a.cloneDeep(r),d.classification.class_property=o.classProperty;var j=d.classification.model_specs;for(var u in j)null===j[u]&&delete j[u];l.append("json",new Blob([JSON.stringify(d)],{type:"application/json"})),0!==o.geojson.features.length&&l.append("samples",new Blob([JSON.stringify(o.geojson)],{type:"application/json"}))}g.a.post(s+"/export",l,{baseURL:".",headers:{"X-CSRFToken":a}}).then((function(e){var t=e.data;i(ke("Export task ID: <b>"+t+"</b>. Please use this ID to check export task status."))})).catch((function(e){i(ke("<b>Failed</b> with the reason: "+e.response.data))})),i(ke("Run export task with parameters: <br>"+JSON.stringify(d)))}}(e)},children:[Object(re.jsx)(Ce.a.Item,{eventKey:"toJpeg",disabled:""===t,children:"Download as thumbnail"}),Object(re.jsx)(Ce.a.Item,{eventKey:"toDrive",children:"Export to Google Drive"})]})},Te=function(){var e=Object(p.c)((function(e){return e.csrfToken})),t=Object(p.c)((function(e){return e.dataset})),a=(Object(p.c)((function(e){return e.appName})),Object(p.c)((function(e){return e.classification}))),c=Object(p.c)((function(e){return e.samples})),s=Object(p.b)(),r=Object(n.useState)(!1),o=Object(m.a)(r,2),i=o[0],l=o[1],d=Object(n.useState)(""),j=Object(m.a)(d,2),b=j[0],h=j[1];return Object(re.jsxs)(u.a,{direction:"horizontal",gap:2,children:[Object(re.jsx)(O.a,{size:"sm",onClick:function(){var n=new FormData,r={};r.dataset=v.a.cloneDeep(t),r.dataset.boundary_file&&(n.append("boundary_file",r.dataset.boundary_file),delete r.dataset.boundary_file),r.classification=v.a.cloneDeep(a),r.classification.class_property=c.classProperty;var o=r.classification.model_specs;for(var i in o)null===o[i]&&delete o[i];n.append("json",new Blob([JSON.stringify(r)],{type:"application/json"})),0!==c.geojson.features.length&&n.append("samples",new Blob([JSON.stringify(c.geojson)],{type:"application/json"})),g.a.post("classification/",n,{baseURL:".",headers:{"X-CSRFToken":e}}).then((function(e){var t=e.data,a=[],n="classification_result",c={layer:new S.a.TileLayer(t[n].tile_url),name:n,url:t[n].download_url};a.push(c),h(t[n].download_url);var r="";if(t.area&&(r+="Rice area: <b>"+t.area.toFixed(3)+" ha</b><br>"),t.confusion_matrix){var o=JSON.parse(t.confusion_matrix),i=t.oa,d=t.kappa;r+='Confusion matrix:\n        <div>\n          <table class="table table-bordered table-sm">\n          <thead>\n            <tr>\n              <th scope="col"></th>\n              <th scope="col">0</th>\n              <th scope="col">1</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr>\n              <th scope="row">0</td>\n              <td >'.concat(o[0][0],"</td>\n              <td >").concat(o[0][1],'</td>\n            </tr>\n            <tr>\n              <th scope="row">1</td>\n              <td >').concat(o[1][0],"</td>\n              <td >").concat(o[1][1],"</td>\n            </tr>\n          </tbody>\n          </table>\n          </div>\n\n          <p>Overall Accuracy: <b>").concat(i,"</b></p>\n          <p>Kappa: <b>").concat(d,"</b></p>\n          ")}Oe(a),s(ke(r)),l(!1)})).catch((function(e){l(!1),s(ke("<b>Failed</b> with the reason: "+e.response.data))})),s(ke("Run supervised classification with the following parameters: <br>"+JSON.stringify(r))),l(!0),xe()},variant:i?"secondary":"primary",disabled:i,style:{width:"100px"},children:i?Object(re.jsxs)("div",{className:"d-flex align-items-center",children:[Object(re.jsx)(f.a,{as:"span",animation:"border",size:"sm",role:"status"}),Object(re.jsx)("div",{children:"Running "})]}):"Run"}),Object(re.jsx)(Ie,{downloadUrl:b})]})},Le=function(){var e=Object(p.c)((function(e){return e.csrfToken})),t=Object(p.c)((function(e){return e.dataset})),a=Object(p.c)((function(e){return e.seasons})),c=Object(p.b)(),s=Object(n.useState)(!1),r=Object(m.a)(s,2),o=(r[0],r[1]),i=Object(n.useState)(!1),l=Object(m.a)(i,2),d=l[0],j=l[1],b=Object(n.useState)(""),h=Object(m.a)(b,2),x=h[0],y=h[1];return Object(re.jsxs)(u.a,{direction:"horizontal",gap:2,children:[Object(re.jsx)(O.a,{size:"sm",variant:d?"secondary":"primary",disabled:d,onClick:function(n){if(n.preventDefault(),!1===n.currentTarget.checkValidity())return n.stopPropagation(),void o(!0);o(!1);var s=new FormData,r={};r.op=a.op,r.seasons=a.seasons,r.dataset=v.a.cloneDeep(t),r.dataset.boundary_file&&(s.append("boundary_file",r.dataset.boundary_file),delete r.dataset.boundary_file),s.append("json",new Blob([JSON.stringify(r)],{type:"application/json"})),g.a.post("empirical/",s,{baseURL:".",headers:{"X-CSRFToken":e}}).then((function(e){var t=e.data;y(t.combined.download_url);var a=[];Object.keys(t).forEach((function(e){var n={layer:new S.a.TileLayer(t[e].tile_url),name:e,url:t[e].download_url};a.push(n),t[e].area&&c(ke("Rice area: <b>"+t[e].area.toFixed(3)+" ha</b>\n"))})),Oe(a),j(!1)})).catch((function(e){j(!1),c(ke("<b>Failed</b> with the reason: "+e.response.data))})),c(ke("Run threshold-based classification with the following parameters: <br>"+JSON.stringify(r))),j(!0),xe()},style:{width:"100px"},children:d?Object(re.jsxs)("div",{className:"d-flex align-items-center",children:[Object(re.jsx)(f.a,{as:"span",animation:"border",size:"sm",role:"status"}),Object(re.jsx)("div",{children:"Running "})]}):"Run"}),Object(re.jsx)(Ie,{downloadUrl:x})]})},De=a(9),Re=a(354),Pe=a(177),Ee=Object(R.b)({name:"dataset",initialState:{name:"COPERNICUS/S1_GRD",cloud:"15",feature:"VH",composite:"median",composite_days:"15",ascd:!1,desc:!0,boundary:"CHITAWAN",boundary_file:null,use_crop_mask:!0,crop_mask:"projects/testee-319020/assets/terai_agri_mask",phenology_start_date:"2019-01-01",phenology_end_date:"2020-01-01"},reducers:{update:function(e,t){return Object(X.a)(Object(X.a)({},e),t.payload)},changeDataSource:function(e,t){var a=t.payload;return e.name=a,a in I.radar?e.feature="VH":a in I.optical&&(e.feature="NDVI",e.cloud="15"),e}}}),Ge=Ee.actions,ze=Ge.update,Ue=Ge.changeDataSource,He=Ee.reducer;function Be(e){e.disabled;var t=Object(p.c)((function(e){return e.dataset})),a=Object(p.b)(),n=function(e,t){a(ze(Object(De.a)({},e,t)))};return Object(re.jsxs)(V.a,{className:"mb-2 border-secondary",children:[Object(re.jsx)(V.a.Header,{children:Object(re.jsx)("h6",{className:"m-0 p-0",children:"Satellite Dataset"})}),Object(re.jsxs)(V.a.Body,{children:[Object(re.jsxs)(W.a.Group,{as:Re.a,controlId:"dataset_name",className:"mb-2 align-items-center",children:[Object(re.jsx)(W.a.Label,{column:!0,xs:4,children:"Dataset"}),Object(re.jsx)(Pe.a,{xs:8,children:Object(re.jsx)(W.a.Select,{onChange:function(e){a(Ue(e.target.value))},value:t.name,children:Object.entries(I).map((function(e){var t=Object(m.a)(e,2),a=t[0],n=t[1];return Object(re.jsx)("optgroup",{label:a,children:Object.entries(n).map((function(e){var t=Object(m.a)(e,2),a=t[0],n=t[1];return Object(re.jsx)("option",{value:a,children:n},a)}))},a)}))})})]}),t.name in I.optical?Object(re.jsxs)(W.a.Group,{as:Re.a,controlId:"dataset_cloud",className:"align-items-center mb-2",children:[Object(re.jsx)(W.a.Label,{column:!0,xs:"auto",children:"Cloud cover (%)"}),Object(re.jsx)(Pe.a,{children:Object(re.jsx)(W.a.Control,{type:"number",min:"0",max:"100",step:"1",value:t.cloud,onChange:function(e){return n("cloud",e.target.value)}})})]}):null,Object(re.jsxs)(W.a.Group,{as:Re.a,controlId:"dataset_orbit",className:"mb-2",children:[Object(re.jsx)(W.a.Label,{column:!0,xs:4,children:"Orbit"}),Object(re.jsxs)(Pe.a,{xs:8,children:[Object(re.jsx)(W.a.Check,{type:"checkbox",id:"desc",name:"desc",label:"Descending",checked:t.desc,onChange:function(e){return n("desc",e.target.checked)}}),Object(re.jsx)(W.a.Check,{type:"checkbox",id:"ascd",name:"ascd",label:"Ascending",checked:t.ascd,onChange:function(e){return n("ascd",e.target.checked)}})]})]}),Object(re.jsxs)(W.a.Group,{as:Re.a,controlId:"dataset_feature",className:"mb-2 align-items-center",children:[Object(re.jsx)(W.a.Label,{column:!0,xs:4,children:"Feature"}),Object(re.jsx)(Pe.a,{xs:8,children:Object(re.jsx)(W.a.Select,{onChange:function(e){return n("feature",e.target.value)},value:t.feature,children:t.name in I.radar?Object.entries(T).map((function(e){var t=Object(m.a)(e,2),a=t[0],n=t[1];return Object(re.jsx)("option",{value:a,children:n},a)})):Object.entries(L).map((function(e){var t=Object(m.a)(e,2),a=t[0],n=t[1];return Object(re.jsx)("option",{value:a,children:n},a)}))})})]}),Object(re.jsxs)(W.a.Group,{as:Re.a,controlId:"dataset_composite",className:"mb-2 align-items-center",children:[Object(re.jsx)(W.a.Label,{column:!0,xs:4,children:"Composite Type"}),Object(re.jsx)(Pe.a,{xs:8,children:Object(re.jsx)(W.a.Select,{onChange:function(e){return n("composite",e.target.value)},value:t.composite,children:["minimum","maximum","median","mean","mode"].map((function(e){return Object(re.jsx)("option",{value:e,children:e},e)}))})})]}),Object(re.jsxs)(W.a.Group,{as:Re.a,controlId:"dataset_composite_days",className:"mb-2 align-items-center",children:[Object(re.jsx)(W.a.Label,{column:!0,xs:4,children:"Composite Days"}),Object(re.jsx)(Pe.a,{xs:8,children:Object(re.jsx)(W.a.Control,{type:"number",onChange:function(e){return n("composite_days",e.target.value)},value:t.composite_days})})]})]})]})}var Fe=function(e){var t=Object(p.c)((function(e){return e.dataset})),a=Object(p.b)(),n=function(e,t){a(ze(Object(De.a)({},e,t)))};return Object(re.jsxs)(V.a,{className:"mb-2 border-secondary",children:[Object(re.jsx)(V.a.Header,{children:Object(re.jsx)("h6",{className:"m-0 p-0",children:"Auxiliary Datasets"})}),Object(re.jsxs)(V.a.Body,{children:[Object(re.jsxs)(W.a.Group,{as:Re.a,controlId:"dataset_boundary",className:"mb-2 align-items-center",children:[Object(re.jsx)(W.a.Label,{column:!0,xs:4,children:"Boundary"}),Object(re.jsx)(Pe.a,{xs:8,children:Object(re.jsx)(W.a.Select,{onChange:function(e){return n("boundary",e.target.value)},value:t.boundary,children:Object.entries(w).map((function(e){var t=Object(m.a)(e,2),a=t[0],n=t[1];return Object(re.jsx)("option",{value:a,children:n},a)}))})})]}),"upload"===t.boundary?Object(re.jsxs)(W.a.Group,{as:Re.a,controlId:"dataset_boundary_file",className:"align-items-center mb-2",children:[Object(re.jsxs)(W.a.Label,{column:!0,xs:4,children:["Boundary file ",Object(re.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(re.jsx)(Pe.a,{xs:8,children:Object(re.jsx)(W.a.Control,{type:"file",className:"w-100 form-control",required:!0,name:"boundary_file",onChange:function(e){return n("boundary_file",URL.createObjectURL(e.target.files[0]))}})})]}):null,Object(re.jsxs)(W.a.Group,{as:Re.a,controlId:"use_cropmask",className:"align-items-center",children:[Object(re.jsx)(W.a.Label,{column:!0,xs:4,children:"Crop Mask"}),Object(re.jsx)(Pe.a,{xs:8,children:Object(re.jsx)(W.a.Check,{type:"checkbox",label:"",checked:t.use_crop_mask,onChange:function(e){return n("use_crop_mask",e.target.checked)}})})]}),t.use_crop_mask?Object(re.jsxs)(W.a.Group,{as:Re.a,controlId:"dataset_cropmask",className:"mb-2 align-items-center",children:[Object(re.jsx)(W.a.Label,{column:!0,xs:4,children:"(GEE asset)"}),Object(re.jsx)(Pe.a,{xs:8,children:Object(re.jsx)(W.a.Control,{type:"text",onChange:function(e){return n("crop_mask",e.target.value)},value:t.crop_mask})})]}):null]})]})},Me=a(355),Ve={changeOp:function(e,t){e.op=t.payload},changeSeasonName:function(e,t){var a=t.payload,n=a.oldName,c=a.newName,s=e.seasons.findIndex((function(e){return e.name===n}));return-1!==s&&(e.seasons[s].name=c),e},addSeason:function(e,t){return e.seasons.push({name:"None",start:"",end:"",min:"",max:""}),e},deleteSeason:function(e,t){var a=e.seasons.findIndex((function(e){return e.name===t.payload}));return-1!==a&&e.seasons.splice(a,1),e},modifySeason:function(e,t){var a=e.seasons.findIndex((function(e){return e.name===t.payload.name}));return-1!==a&&(e.seasons[a]=Object(X.a)(Object(X.a)({},e.seasons[a]),t.payload)),e}},We=Object(R.b)({name:"seasons",initialState:{op:"and",seasons:[{name:"transplant",start:"",end:"",min:"",max:""}]},reducers:Ve}),Je=We.actions,Ke=Je.changeOp,qe=Je.changeSeasonName,Xe=Je.addSeason,Ye=Je.deleteSeason,$e=Je.modifySeason,Qe=We.reducer,Ze=a(356),et=function(e){var t=e.idx,a=e.inputThres,c=e.readOnly,s=Object(p.c)((function(e){return e.seasons.seasons[t]})),r=Object(p.b)(),o=Object(n.useState)(s.name),i=Object(m.a)(o,2),l=i[0],d=i[1],j=Object(n.useState)(!1),u=Object(m.a)(j,2),b=u[0],h=u[1],f=function(e,t){r($e(Object(De.a)({name:s.name},e,t)))};return Object(re.jsxs)(V.a,{className:"mb-2 border-secondary",children:[Object(re.jsxs)(Re.a,{className:"align-items-center gx-2 m-0 card-header",children:[Object(re.jsx)(Pe.a,{xs:"auto",children:Object(re.jsx)(Me.a,{size:"sm",type:"checkbox",checked:b,variant:"outline-secondary",onClick:function(e){b&&r(qe({oldName:s.name,newName:l})),h(!b)},children:Object(re.jsx)(Ze.a,{})})}),Object(re.jsx)(Pe.a,{children:b?Object(re.jsx)(W.a.Control,{plaintext:!b,readOnly:!b,onChange:function(e){d(e.target.value)},defaultValue:l}):Object(re.jsx)("h6",{className:"mb-0",children:l})}),Object(re.jsx)(Pe.a,{xs:"auto",children:Object(re.jsx)(O.a,{size:"sm",variant:"danger",onClick:function(e){r(Ye(s.name))},children:"X"})})]}),Object(re.jsx)("fieldset",{id:"".concat(s.name,"_fields"),children:Object(re.jsxs)(V.a.Body,{children:[Object(re.jsxs)(W.a.Group,{as:Re.a,className:"mb-2",controlId:"".concat(s.name,"_start_fields"),children:[Object(re.jsxs)(W.a.Label,{column:!0,sm:4,children:["Start date ",Object(re.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(re.jsx)(Pe.a,{sm:8,children:Object(re.jsx)(W.a.Control,{type:"date",required:!0,name:"".concat(s.name,"_start"),value:s.start,onChange:function(e){return f("start",e.target.value)}})})]}),Object(re.jsxs)(W.a.Group,{as:Re.a,className:"mb-2",controlId:"".concat(s.name,"_end_fields"),children:[Object(re.jsxs)(W.a.Label,{column:!0,sm:4,children:["End date ",Object(re.jsx)("span",{style:{color:"red"},children:"*"})]}),Object(re.jsx)(Pe.a,{sm:8,children:Object(re.jsx)(W.a.Control,{type:"date",required:!0,name:"".concat(s.name,"_end"),value:s.end,onChange:function(e){return f("end",e.target.value)}})})]}),Object(re.jsxs)(W.a.Group,{as:Re.a,className:"mb-2",children:[Object(re.jsxs)(W.a.Label,{column:!0,sm:4,children:["Threshold ",a?Object(re.jsx)("span",{style:{color:"red"},children:"*"}):null]}),Object(re.jsx)(Pe.a,{sm:8,children:Object(re.jsxs)(Re.a,{className:"gx-1 align-items-center",children:[Object(re.jsx)(Pe.a,{children:Object(re.jsx)(W.a.Control,{type:"number",required:a,readOnly:!a||c,id:"".concat(s.name,"_min"),placeholder:"min",step:"0.01",name:"".concat(s.name,"_min"),value:s.min,onChange:function(e){return f("min",e.target.value)}})}),Object(re.jsx)(Pe.a,{sm:"auto",children:"\u2264 x \u2264"}),Object(re.jsx)(Pe.a,{children:Object(re.jsx)(W.a.Control,{type:"number",required:a,readOnly:!a||c,id:"".concat(s.name,"_max"),placeholder:"max",step:"0.01",name:"".concat(s.name,"_max"),value:s.max,onChange:function(e){return f("max",e.target.value)}})})]})})]})]})})]})},tt=a(117),at=function(){var e=Object(p.c)((function(e){return e.csrfToken})),t=Object(p.c)((function(e){return e.dataset})),a=Object(p.c)((function(e){return e.seasons})),c=Object(p.c)((function(e){return e.samples})),s=Object(p.b)(),r=Object(n.useState)(!1),o=Object(m.a)(r,2),i=o[0],l=o[1],d=Object(n.useState)(!1),j=Object(m.a)(d,2),b=(j[0],j[1]);return Object(re.jsxs)(u.a,{direction:"horizontal",gap:2,children:[Object(re.jsx)(O.a,{size:"sm",onClick:function(a){if(a.preventDefault(),!1===a.currentTarget.checkValidity())return a.stopPropagation(),void b(!0);b(!1);var n={};n.dataset=v.a.cloneDeep(t),delete n.dataset.boundary_file;var r=v.a.cloneDeep(c.geojson);r.features.forEach((function(e){Object.keys(e.properties).forEach((function(t){t.endsWith("_feature")&&delete e.properties[t]}))})),n.samples=r,n.phenology_dates=c.phenology,g.a.post("phenology/",n,{baseURL:".",headers:{"X-CSRFToken":e}}).then((function(e){e.data.features.forEach((function(e){r.features.filter((function(t){return t.properties[oe]===e.properties[oe]}))[0].properties=e.properties})),s(Q(r)),l(!1)})).catch((function(e){l(!1),alert(e.response.data)})),l(!0)},variant:i?"secondary":"primary",disabled:i,style:{width:"150px"},children:i?Object(re.jsxs)("div",{className:"d-flex align-items-center justify-content-center",children:[Object(re.jsx)(f.a,{as:"span",animation:"border",size:"sm",role:"status"}),Object(re.jsx)("div",{children:"Running "})]}):"Get Phenology"}),Object(re.jsx)(O.a,{size:"sm",onClick:function(e){0!==c.geojson.features.length?a.seasons.forEach((function(e){var t=new Date(e.start),a=new Date(e.end),n=[];if(c.geojson.features.forEach((function(e){e.properties[c.classProperty.name]===c.classProperty.positiveValue&&Object.entries(e.properties).forEach((function(e){var c=Object(m.a)(e,2),s=c[0],r=c[1];if(s.endsWith("_feature")){var o=s.split("_"),i=new Date(Number.parseInt(o[o.length-2])).getTime();t.getTime()<=i&&i<=a.getTime()&&n.push(r)}}))})),0!==n.length){var r=function(e){var t=tt.a(e,.25),a=tt.a(e,.75),n=a-t,c=a+1.5*n,s=t-1.5*n;return e.filter((function(e){return e>s&&e<c}))}(n),o=v.a.sum(r)/r.length,i=Math.sqrt(v.a.sum(v.a.map(r,(function(e){return Math.pow(e-o,2)})))/r.length);s($e({name:e.name,min:(o-i).toFixed(2),max:(o+i).toFixed(2)}))}})):alert("Please upload the ground truth samples first.")},children:"Calculate Thresholds"})]})},nt=a(370),ct=a(369),st=a(357),rt={COMPLETED:"success",RUNNING:"secondary",READY:"primary",FAILED:"danger",CANCELLED:"warning"},ot=function(){var e,t=Object(n.useState)([]),a=Object(m.a)(t,2),c=(a[0],a[1]),s=Object(n.useState)(null),r=Object(m.a)(s,2),o=r[0],i=r[1],l=Object(n.useState)(!1),d=Object(m.a)(l,2),j=d[0],u=d[1],b=Object(n.useState)(null),p=Object(m.a)(b,2),h=p[0],f=p[1],x=Object(n.useState)(!1),y=Object(m.a)(x,2),v=y[0],N=y[1];return Object(re.jsxs)(n.Fragment,{children:[Object(re.jsx)(O.a,{size:"sm",variant:"info",onClick:function(e){g.a.get("tasks/").then((function(e){c(e.data)})),u(!0)},children:"Export Status"}),Object(re.jsxs)(nt.a,{size:"lg",show:j,onHide:function(e){u(!1),i(null),f(null)},children:[Object(re.jsx)(nt.a.Header,{children:"Task Status"}),Object(re.jsxs)(nt.a.Body,{children:[Object(re.jsxs)(W.a.Group,{as:Re.a,className:"mb-3",controlId:"formPlaintextEmail",children:[Object(re.jsx)(W.a.Label,{column:!0,sm:"auto",children:"Task ID"}),Object(re.jsx)(Pe.a,{sm:!0,children:Object(re.jsx)(W.a.Control,{value:h,onChange:function(e){return f(e.target.value)}})}),Object(re.jsx)(Pe.a,{sm:"auto",children:Object(re.jsx)(O.a,{disabled:v,onClick:function(e){N(!0),g.a.get("tasks/"+h).then((function(e){i(e.data),N(!1),null===e.data&&alert("Task not found")}))},children:v?"Loading":"Search"})})]}),Object(re.jsx)(ct.a,{children:null!==o?Object(re.jsxs)(ct.a.Item,{eventKey:o.id,children:[Object(re.jsxs)(ct.a.Header,{children:[Object(re.jsx)(st.a,{bg:rt[o.state],children:o.state})," ","  ",o.id]}),Object(re.jsxs)(ct.a.Body,{children:[(e=o,Object(re.jsxs)(M.a,{striped:!0,bordered:!0,hover:!0,children:[Object(re.jsxs)("thead",{children:[Object(re.jsx)("th",{children:"key"}),Object(re.jsx)("th",{children:"value"})]}),Object(re.jsx)("tbody",{children:Object.entries(e).map((function(e){var t=Object(m.a)(e,2),a=t[0],n=t[1];return Object(re.jsxs)("tr",{children:[Object(re.jsx)("td",{children:a}),Object(re.jsx)("td",{children:JSON.stringify(n)})]},a)}))})]})),"COMPLETED"===o.state?Object(re.jsx)(O.a,{size:"sm",onClick:function(e){g.a.get("download/"+h,{responseType:"blob"}).then((function(e){Object(se.saveAs)(new Blob([e.data],{type:"image/tiff"}),h+".tif")}))},children:"Download"}):null]})]}):null})]})]})]})},it=function(){var e=Object(p.c)((function(e){return e.appName}));return Object(re.jsx)(i.a,{bg:"dark",variant:"dark",expand:"lg",className:"header",fixed:"top",children:Object(re.jsxs)(l.a,{fluid:!0,children:[Object(re.jsx)(i.a.Brand,{href:"/",children:"RiceMapEngine"}),Object(re.jsx)(i.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(re.jsxs)(i.a.Collapse,{id:"basic-navbar-nav",children:[Object(re.jsxs)(d.a,{className:"me-auto",children:[Object(re.jsx)(d.a.Link,{to:"/phenology",as:h.b,children:"Phenology Explorer"}),Object(re.jsxs)(j.a,{title:"Rice Mapping",children:[Object(re.jsx)(j.a.Item,{to:"/empirical",as:h.b,children:"Empirical Thresholding"}),Object(re.jsx)(j.a.Item,{to:"/classification",as:h.b,children:"Supervised Classification"})]}),Object(re.jsx)(d.a.Link,{href:"./user-manual.html",target:"_blank",children:Object(re.jsxs)("div",{className:"d-flex align-items-center",children:[Object(re.jsx)("div",{className:"pe-1",children:"User Manual"}),Object(re.jsx)(b.a,{})]})})]}),Object(re.jsxs)(u.a,{direction:"horizontal",gap:2,children:["classification"===e?Object(re.jsx)(Te,{}):"empirical"===e?Object(re.jsx)(Le,{}):Object(re.jsx)(at,{}),Object(re.jsx)(ot,{})]})]})]})})},lt={home:"home",empirical:"empirical",phenology:"phenology",classification:"classification"},dt=Object(R.b)({name:lt.home,initialState:null,reducers:{setAppName:function(e,t){return t.payload}}}),jt=dt.actions.setAppName,ut=dt.reducer;var bt=function(){var e=Object(p.b)();return Object(n.useEffect)((function(){e(jt(lt.home))}),[]),Object(re.jsx)("div",{children:Object(re.jsx)("h1",{children:"Hello"})})};var pt=Object(R.b)({name:"csrfToken",initialState:null,reducers:{setToken:function(e,t){return t.payload}}}),ht=pt.actions.setToken,mt=pt.reducer;a(337);var Ot=a(125),ft=a(377),xt=a(363),gt=a(364),yt=a(181),vt=a(361),Nt=function(){var e=Object(n.useState)(!1),t=Object(m.a)(e,2),a=t[0],c=t[1],s=Object(n.useState)(null),r=Object(m.a)(s,2),o=r[0],i=r[1],l=Object(p.c)((function(e){return e.samples}));Object(n.useEffect)((function(){if("number"===typeof l.selected){var e=l.geojson.features.filter((function(e){return e.properties[oe]==l.selected}))[0];i(function(e){var t={};if(Object.entries(e.properties).forEach((function(e){var a=Object(m.a)(e,2),n=a[0],c=a[1];if(n.endsWith("_feature")){var s=n.split("_"),r=new Date(Number.parseInt(s[s.length-2])).getTime();t[r]=99999===c?null:c}})),0===Object.keys(t).length)return null;var a=[["date","value"]];return Object.keys(t).sort((function(e,t){return Number.parseInt(e)-Number.parseInt(t)})).forEach((function(e){var n=Array(a[0].length).fill(null);n[0]=new Date(Number.parseInt(e)),n[1]=t[e],a.push(n)})),a}(e))}}),[l.selected,l.geojson]);return Object(re.jsxs)(n.Fragment,{children:[Object(re.jsx)(V.a,{className:"h-100 w-100",children:Object(re.jsxs)(V.a.Body,{className:"p-2",children:[Object(re.jsx)(St,{chartData:o}),Object(re.jsxs)("div",{className:"position-absolute bottom-0 end-0 d-flex justify-content-end mb-1",children:[Object(re.jsxs)(_e.a,{size:"sm",title:"Download...",onSelect:function(e,t){var a="";if("one"===e)a=o.map((function(e){return e.join(",")})).join("\n");else{var n=l.geojson.features.filter((function(e){return e.properties[l.classProperty.name]===l.classProperty.positiveValue})),c={};n.forEach((function(e){Object.entries(e.properties).forEach((function(e){var t=Object(m.a)(e,2),a=t[0],n=t[1];if(a.endsWith("_feature")){var s=a.split("_"),r=new Date(Number.parseInt(s[s.length-2])).getTime();void 0===c[r]&&(c[r]=[]),c[r].push(99999===n?null:n)}}))})),a=Object.entries(c).sort((function(e,t){return e[0]-t[0]})).map((function(e){var t=Object(m.a)(e,2),a=t[0],n=t[1];return new Date(Number.parseInt(a))+","+n.join(",")})).join("\n")}var s=new Blob([a],{type:"text/csv;charset=utf-8"});Object(se.saveAs)(s,"phenology.csv")},children:[Object(re.jsx)(Ce.a.Item,{eventKey:"one",disabled:!o,children:"Phenology of the selected sample"}),Object(re.jsxs)(Ce.a.Item,{eventKey:"all",children:["Phenology of all ",l.classProperty.positiveValue," samples"]})]}),Object(re.jsx)(O.a,{size:"sm",variant:"secondary",onClick:function(){return c(!0)},children:Object(re.jsx)(vt.a,{size:11})})]})]})}),Object(re.jsxs)(nt.a,{fullscreen:!0,show:a,onHide:function(){return c(!1)},children:[Object(re.jsx)(nt.a.Header,{closeButton:!0,children:Object(re.jsx)(nt.a.Title,{children:"Phenology Chart"})}),Object(re.jsx)(nt.a.Body,{children:Object(re.jsx)(St,{chartData:o})})]})]})},St=function(e){var t=e.chartData;return t?Object(re.jsx)(yt.a,{width:"100%",height:"90%",chartType:"LineChart",loader:Object(re.jsx)("div",{children:"Loading Chart..."}),data:t,options:{hAxis:{title:"Date",format:"yyyy-MM-dd"},vAxis:{title:"Value"},legend:{position:"bottom"},pointSize:3},rootProps:{"data-testid":"1"},legendToggle:!0}):"Select a sample to show its phenology."},_t=a(362),Ct=function(){var e=Object(p.c)((function(e){return e.appName})),t=(Object(p.c)((function(e){return e.samples})),Object(p.c)((function(e){return e.seasons}))),a=Object(p.b)();return Object(re.jsxs)(n.Fragment,{children:[t.seasons.map((function(t,a){return Object(re.jsx)(et,{idx:a,readOnly:!1,inputThres:"phenology"!==e},a)})),Object(re.jsx)("div",{className:"mb-2",children:Object(re.jsxs)(O.a,{variant:"secondary",className:"w-100",onClick:function(){a(Xe())},children:[Object(re.jsx)(_t.a,{})," "," ","Add phenology phase"]})})]})},At="Samples",kt="Phenology Phases";function wt(){return Object(re.jsx)("div",{className:"h-100 d-flex flex-column",children:Object(re.jsxs)(ft.a,{defaultActiveKey:At,unmountOnExit:!1,children:[Object(re.jsx)(Re.a,{className:"tabs-nav g-0 flex-wrap",children:Object(re.jsxs)(d.a,{variant:"pills",className:"h-100",children:[Object(re.jsx)(Pe.a,{className:"h-100 align-items-center p-1",children:Object(re.jsx)(d.a.Link,{className:"tab-title align-middle w-100 h-100 h6 mb-0",eventKey:At,children:At})}),Object(re.jsx)(Pe.a,{className:"h-100 align-items-center p-1",children:Object(re.jsx)(d.a.Link,{className:"tab-title align-middle h-100 w-100 h6 mb-0",eventKey:kt,children:kt})})]})}),Object(re.jsx)(Re.a,{className:"overflow-auto h-100 g-0 mb-auto",children:Object(re.jsx)(Pe.a,{className:"h-100 w-100",children:Object(re.jsxs)(xt.a,{className:"h-100 w-100",children:[Object(re.jsxs)(gt.a,{eventKey:At,className:"h-100 w-100",children:[Object(re.jsx)("div",{className:"sample-container h-100 px-2 pt-2",children:Object(re.jsx)(de,{})}),Object(re.jsx)("div",{className:"chart-canvas w-100 px-2 pt-2",children:Object(re.jsx)(Nt,{})})]}),Object(re.jsx)(gt.a,{eventKey:kt,className:"h-100 p-2",children:Object(re.jsx)(Ct,{})})]})})})]})})}function It(e){var t=Object(n.useState)(!1),a=Object(m.a)(t,2),c=a[0];a[1];return Object(re.jsx)("div",{className:"h-100 flex-column p-2",children:Object(re.jsx)(W.a,{method:"POST",noValidate:!0,validated:c,children:Object(re.jsx)(Be,{})})})}var Tt=function(e){var t=Object(n.useState)(!1),a=Object(m.a)(t,2),c=a[0];a[1];return Object(re.jsx)("div",{className:"sidebar h-100 flex-column p-2",children:Object(re.jsx)(W.a,{method:"POST",noValidate:!0,validated:c,children:Object(re.jsxs)("fieldset",{children:[Object(re.jsx)(Be,{}),Object(re.jsx)(Fe,{})]})})})};function Lt(){var e=Object(p.c)((function(e){return e.seasons})),t=Object(p.b)(),a=function(e){t(Ke(e))};return Object(re.jsxs)("div",{className:"h-100 d-flex flex-column p-2",children:[Object(re.jsx)(V.a,{className:"mb-2",children:Object(re.jsxs)(V.a.Body,{className:"d-flex",children:[Object(re.jsx)("div",{className:"px-2",children:"Aggregate method"}),Object(re.jsxs)("div",{className:"d-flex flex-grow-1 justify-content-around",children:[Object(re.jsx)(W.a.Check,{checked:"and"===e.op,type:"radio",label:"All",onChange:function(){return a("and")}}),Object(re.jsx)(W.a.Check,{checked:"or"===e.op,type:"radio",label:"Any",onChange:function(){return a("or")}})]})]})}),Object(re.jsx)(Ct,{})]})}var Dt=a(371),Rt=a(183),Pt={"Random Forest":{numberOfTrees:{type:"int",required:!0,default:200,description:"The number of decision trees to create."},variablesPerSplit:{type:"int",default:null,description:"The number of variables per split. If unspecified, uses the square root of the number of variables."},minLeafPopulation:{type:"int",default:1,description:"Only create nodes whose training set contains at least this many points."},bagFraction:{type:"float",default:.5,description:"The fraction of input to bag per tree."},maxNodes:{type:"int",default:null,description:"The maximum number of leaf nodes in each tree. If unspecified, defaults to no limit."},seed:{type:"int",default:0,description:"The randomization seed."}}},Et=Object(R.b)({name:"classification",initialState:{start_date:null,end_date:null,training_ratio:.7,model:"",model_specs:{}},reducers:{update:function(e,t){return Object(X.a)(Object(X.a)({},e),t.payload)},updateModelSpecs:function(e,t){return Object(X.a)(Object(X.a)({},e),{},{model_specs:Object(X.a)(Object(X.a)({},e.model_specs),t.payload)})},changeModel:function(e,t){t.payload&&t.payload!==e.model&&(e.model_specs={},Object.keys(Pt[t.payload]).forEach((function(a){"default"in Pt[t.payload][a]?e.model_specs[a]=Pt[t.payload][a].default:e.model_specs[a]=null}))),e.model=t.payload}}}),Gt=Et.actions,zt=Gt.update,Ut=Gt.updateModelSpecs,Ht=Gt.changeModel,Bt=Et.reducer,Ft=a(365),Mt=function(e){var t=Object(p.c)((function(e){return e.classification})),a=Object(p.b)(),c=function(e,t){"model"===e?a(Ht(t)):e.startsWith("model")?a(Ut(Object(De.a)({},e.split(".")[1],t))):a(zt(Object(De.a)({},e,t)))};return Object(re.jsxs)(n.Fragment,{children:[Object(re.jsxs)(V.a,{className:"mb-2 border-secondary",children:[Object(re.jsx)(V.a.Header,{children:Object(re.jsx)("h6",{className:"m-0 p-0",children:"Image Date Range"})}),Object(re.jsxs)(V.a.Body,{children:[Object(re.jsxs)(W.a.Group,{as:Re.a,controlId:"date_start",className:"mb-2 align-items-center",children:[Object(re.jsx)(W.a.Label,{column:!0,xs:4,children:"Start Date:"}),Object(re.jsx)(Pe.a,{xs:8,children:Object(re.jsx)(W.a.Control,{type:"date",value:t.start_date,onChange:function(e){return c("start_date",e.target.value)}})})]}),Object(re.jsxs)(W.a.Group,{as:Re.a,controlId:"date_end",className:"mb-2 align-items-center",children:[Object(re.jsx)(W.a.Label,{column:!0,xs:4,children:"End Date:"}),Object(re.jsx)(Pe.a,{xs:8,children:Object(re.jsx)(W.a.Control,{type:"date",value:t.end_date,onChange:function(e){return c("end_date",e.target.value)}})})]})]})]}),Object(re.jsxs)(V.a,{className:"mb-2 border-secondary",children:[Object(re.jsx)(V.a.Header,{children:Object(re.jsx)("h6",{className:"m-0 p-0",children:"Classification Details"})}),Object(re.jsxs)(V.a.Body,{children:[Object(re.jsxs)(W.a.Group,{as:Re.a,controlId:"train_test_ratio",className:"mb-2 align-items-center",children:[Object(re.jsx)(W.a.Label,{column:!0,xs:4,children:"Training Ratio:"}),Object(re.jsx)(Pe.a,{xs:8,children:Object(re.jsx)(W.a.Control,{type:"number",step:"0.05",value:t.training_ratio,onChange:function(e){return c("training_ratio",e.target.value)}})})]}),Object(re.jsxs)(W.a.Group,{as:Re.a,controlId:"model",className:"mb-2 align-items-center",children:[Object(re.jsx)(W.a.Label,{column:!0,xs:4,children:"Model:"}),Object(re.jsx)(Pe.a,{xs:8,children:Object(re.jsxs)(W.a.Select,{value:t.model,onChange:function(e){return c("model",e.target.value)},children:[Object(re.jsx)("option",{},""),Object.keys(Pt).map((function(e){return Object(re.jsx)("option",{children:e},e)}))]})})]}),t.model&&Object.keys(Pt[t.model]).map((function(e){return Object(re.jsx)(Vt,{specName:e,handleChange:c})}))]})]})]})},Vt=function(e){var t=e.specName,a=e.handleChange,n=Object(p.c)((function(e){return e.classification})),c=n.model,s=function(e){a("model.".concat(t),e.target.value)};return Object(re.jsxs)(W.a.Group,{as:Re.a,controlId:t,className:"mb-2 align-items-center",children:[Object(re.jsxs)(W.a.Label,{column:!0,xs:4,children:[t,"  ",Object(re.jsx)(Dt.a,{trigger:"hover",placement:"right",overlay:Object(re.jsx)(Rt.a,{children:Object(re.jsx)(Rt.a.Body,{children:Pt[c][t].description})}),children:Object(re.jsx)(Ft.a,{})})]}),Object(re.jsx)(Pe.a,{xs:8,children:function(){switch(Pt[c][t].type){case"int":return Object(re.jsx)(W.a.Control,{type:"number",placeholder:"Leave blank to use default value",step:"1",value:n.model_specs[t],onChange:s});case"float":return Object(re.jsx)(W.a.Control,{type:"number",placeholder:"Leave blank to use default value",step:"0.1",value:n.model_specs[t],onChange:s});case"string":return Object(re.jsx)(W.a.Control,{type:"text",value:n.model_specs[t],onChange:s});case"select":return Object(re.jsx)(W.a.Select,{value:n.model_specs[t],onChange:s,children:Pt[c][t].options.map((function(e){return Object(re.jsx)("option",{children:e},e)}))});default:return Object(re.jsx)(re.Fragment,{})}}()})]})},Wt=function(e){var t=Object(n.useState)(!1),a=Object(m.a)(t,2),c=a[0];a[1];return Object(re.jsx)("div",{className:"sidebar h-100 flex-column p-2",children:Object(re.jsxs)(W.a,{method:"POST",noValidate:!0,validated:c,children:[Object(re.jsxs)("fieldset",{children:[Object(re.jsx)(Be,{}),Object(re.jsx)(Fe,{})]}),Object(re.jsx)(Mt,{})]})})},Jt=function(){return Object(re.jsx)("div",{className:"flex-column p-2",children:Object(re.jsx)(de,{})})},Kt=a(366),qt=function(e){var t=e.date,a=e.point,n=e.setMapObj;return Object(re.jsxs)(C.a,{center:a||[28.5973518,83.54495724],zoom:15,className:"small-map",zoomControl:!1,whenCreated:function(e){n((function(a){return Object(X.a)(Object(X.a)({},a),{},Object(De.a)({},t,e))}))},children:[Object(re.jsx)(k.a,{url:D["Google Satellite"].url,attribution:D["Google Satellite"].attribution}),a&&Object(re.jsx)(Kt.a,{position:a})]})},Xt=function(e){var t=Object(p.c)((function(e){return e.samples})),a=t.geojson.features.filter((function(e){return e.properties[oe]===t.selected}))[0],c=Object(p.b)(),s=Object(n.useState)({}),r=Object(m.a)(s,2),o=r[0],i=r[1];Object(n.useEffect)((function(){t.selected&&Object.values(o).forEach((function(e){e.panTo([a.geometry.coordinates[1],a.geometry.coordinates[0]])}))}),[t.selected]),Object(n.useEffect)((function(){var e={},a=t.phenology,n=a.start_date,c=a.end_date;n=new Date(n),c=new Date(c);for(var s=n;s<=c;){var r="".concat(s.getUTCFullYear(),"-").concat(s.getUTCMonth()+1);e[r]=o[r],s.setUTCMonth(s.getUTCMonth()+1)}i(e)}),[t.phenology]);return Object(re.jsxs)("div",{className:"map-carousel h-100 d-flex overflow-auto",children:[Object(re.jsx)("div",{className:"ps-2 py-2 pe-1",style:{width:280,flexShrink:0},children:Object(re.jsxs)(V.a,{className:"w-100 h-100",children:[Object(re.jsx)(V.a.Header,{children:Object(re.jsx)("h6",{className:"m-0 p-0",children:"Phenology Date Range"})}),Object(re.jsxs)(V.a.Body,{className:"p-2",children:[Object(re.jsxs)(W.a.Group,{as:Re.a,controlId:"phenology_start_date",className:"mb-2",children:[Object(re.jsx)(W.a.Label,{column:!0,sm:"3",children:"From"}),Object(re.jsx)(Pe.a,{sm:"9",children:Object(re.jsx)(W.a.Control,{type:"month",name:"phenology_start_date",value:t.phenology.start_date,onChange:function(e){return c(ae({start_date:e.target.value}))},className:"w-100"})})]}),Object(re.jsxs)(W.a.Group,{as:Re.a,controlId:"phenology_end_date",children:[Object(re.jsx)(W.a.Label,{column:!0,sm:"3",children:"To"}),Object(re.jsx)(Pe.a,{sm:"9",children:Object(re.jsx)(W.a.Control,{type:"month",name:"phenology_end_date",value:t.phenology.end_date,onChange:function(e){return c(ae({end_date:e.target.value}))}})})]}),Object(re.jsx)(Re.a,{className:"pt-2 justify-content-center",children:Object(re.jsx)(Pe.a,{sm:"auto",children:Object(re.jsx)(O.a,{onClick:function(e){g.a.get("phenology/monthly_composite",{baseURL:".",params:{start_date:t.phenology.start_date,end_date:t.phenology.end_date}}).then((function(e){var t=e.data;Object.keys(o).forEach((function(e){var a=t[e];new S.a.TileLayer(a).addTo(o[e])}))}))},children:"Load Composites"})})})]})]})}),Object.keys(o).map((function(e){return Object(re.jsx)("div",{className:"px-1 py-2",style:{width:250,flexShrink:0},children:Object(re.jsxs)(V.a,{className:"w-100 h-100",children:[Object(re.jsx)(V.a.Header,{className:"py-0 text-center",children:e}),Object(re.jsx)(V.a.Body,{className:"p-0",children:Object(re.jsx)(qt,{point:a&&Object(_.a)(a.geometry.coordinates).reverse(),date:e,setMapObj:i})})]},e)})}))]})},Yt=function(){var e=Object(p.c)((function(e){return e.log}));return Object(re.jsx)("div",{className:"w-100 h-100 p-2 bg-white overflow-auto text-break d-flex flex-column-reverse",children:Object(re.jsx)("div",{children:Object(G.a)(e)})})},$t="20%",Qt="40%",Zt="25%",ea="40%";var ta=function(){var e=Object(o.f)(),t=Object(p.b)(),a=Object(p.c)((function(e){return e.appName}));return Object(n.useEffect)((function(){var e=function(e){var t=null;if(document.cookie&&""!==document.cookie)for(var a=document.cookie.split(";"),n=0;n<a.length;n++){var c=a[n].trim();if(c.substring(0,e.length+1)===e+"="){t=decodeURIComponent(c.substring(e.length+1));break}}return t}("csrftoken");t(ht(e))}),[]),Object(n.useEffect)((function(){var a=e.pathname.split("/"),n=a[a.length-1]||"home";t(jt(lt[n]))}),[e]),Object(re.jsxs)("div",{className:"vh-100 vw-100",children:[Object(re.jsx)(it,{}),Object(re.jsx)("div",{className:"main d-flex h-100 w-100",children:Object(re.jsxs)(o.c,{children:[Object(re.jsx)(o.a,{exact:!0,path:"/",children:Object(re.jsx)(bt,{})}),Object(re.jsx)(o.a,{path:["/empirical","/phenology","/classification"],children:Object(re.jsxs)(Ot.a,{split:"vertical",defaultSize:$t,minSize:0,maxSize:Qt,className:"h-100 position-static",children:[Object(re.jsx)("div",{className:"h-100 w-100",children:Object(re.jsxs)(o.c,{children:[Object(re.jsx)(o.a,{exact:!0,path:"/empirical",children:Object(re.jsx)(Tt,{})}),Object(re.jsx)(o.a,{exact:!0,path:"/phenology",children:Object(re.jsx)(It,{})}),Object(re.jsx)(o.a,{exact:!0,path:"/classification",children:Object(re.jsx)(Wt,{})})]})}),Object(re.jsxs)(Ot.a,{split:"vertical",primary:"second",defaultSize:Zt,minSize:0,maxSize:ea,children:[Object(re.jsx)("div",{className:"h-100 w-100",children:Object(re.jsxs)(Ot.a,{split:"horizontal",primary:"second",defaultSize:250,maxSize:400,minSize:0,children:[Object(re.jsx)("div",{className:"w-100 h-100",children:Object(re.jsx)(ye,{})}),Object(re.jsx)("div",{className:"w-100",children:"phenology"===a?Object(re.jsx)(Xt,{}):Object(re.jsx)(Yt,{})})]})}),Object(re.jsxs)("div",{className:"h-100",children:[Object(re.jsx)(o.a,{exact:!0,path:"/phenology",children:Object(re.jsx)("div",{className:"h-100 w-100",children:Object(re.jsx)(wt,{})})}),Object(re.jsx)(o.a,{exact:!0,path:"/empirical",children:Object(re.jsx)(Lt,{})}),Object(re.jsx)(o.a,{exact:!0,path:"/classification",children:Object(re.jsx)(Jt,{})})]})]})]})})]})})]})},aa=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,378)).then((function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,s=t.getLCP,r=t.getTTFB;a(e),n(e),c(e),s(e),r(e)}))},na=(a(339),Object(R.a)({reducer:{csrfToken:mt,dataset:He,seasons:Qe,samples:ne,editing:E,appStatus:Se,appName:ut,classification:Bt,log:we}}));r.a.render(Object(re.jsx)(c.a.StrictMode,{children:Object(re.jsx)(h.a,{basename:".",children:Object(re.jsx)(p.a,{store:na,children:Object(re.jsx)(ta,{})})})}),document.getElementById("root")),aa()}},[[341,1,2]]]);
//# sourceMappingURL=main.b4f5f5e5.chunk.js.map